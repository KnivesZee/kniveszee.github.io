<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta name="baidu-site-verification" content="UqlC4pwKIm">
  <meta name="baidu-site-verification" content="d3U0dGeqGw">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="google-site-verification" content="1C1XSuJ8TgM2O0mcZvsgzEdy0IdRZOJfxDYPyh18U9Q">














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.cat.net/css?family=Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="language,">










<meta name="description" content="我们会出于各种目的学习自然语言。外语能带你领略一片从未见过的风景。程序语言也是如此：每学一门新的语言，思维方式就会发生改变。 首先选择的是一门面向对象的语言Ruby。Ruby是由松本行弘（Matz）于1993年发明，从语言角度看，它出身于脚本语言家族。它有如下特性：  解释型:Ruby代码由解释器而非编译器执行 动态类型：意味着类型在运行时而非编译时绑定 面向对象：意味着Ruby支持封装（将dat">
<meta name="keywords" content="language">
<meta property="og:type" content="article">
<meta property="og:title" content="Ruby Learning">
<meta property="og:url" content="http://knivezee.site/2018/07/20/2018-07-20-rubyLearnNote/index.html">
<meta property="og:site_name" content="拾碎集">
<meta property="og:description" content="我们会出于各种目的学习自然语言。外语能带你领略一片从未见过的风景。程序语言也是如此：每学一门新的语言，思维方式就会发生改变。 首先选择的是一门面向对象的语言Ruby。Ruby是由松本行弘（Matz）于1993年发明，从语言角度看，它出身于脚本语言家族。它有如下特性：  解释型:Ruby代码由解释器而非编译器执行 动态类型：意味着类型在运行时而非编译时绑定 面向对象：意味着Ruby支持封装（将dat">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://p5gvnfded.bkt.clouddn.com/irb1.png">
<meta property="og:updated_time" content="2018-12-03T08:04:35.487Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ruby Learning">
<meta name="twitter:description" content="我们会出于各种目的学习自然语言。外语能带你领略一片从未见过的风景。程序语言也是如此：每学一门新的语言，思维方式就会发生改变。 首先选择的是一门面向对象的语言Ruby。Ruby是由松本行弘（Matz）于1993年发明，从语言角度看，它出身于脚本语言家族。它有如下特性：  解释型:Ruby代码由解释器而非编译器执行 动态类型：意味着类型在运行时而非编译时绑定 面向对象：意味着Ruby支持封装（将dat">
<meta name="twitter:image" content="http://p5gvnfded.bkt.clouddn.com/irb1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: 'undefined',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://knivezee.site/2018/07/20/2018-07-20-rubyLearnNote/">





  <title>Ruby Learning | 拾碎集</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-111723881-1', 'auto');
  ga('send', 'pageview');
</script>






  <style>
 	.forkme{
 		display: none;
	}
	@media (min-width: 768px) {
 		.forkme{
 			display: inline;
 		}
  	}
  </style>
</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <!-- github小猫 start -->
<!--     <a href="https://github.com/KnivesZee" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#70B7FD; color:#fff; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style> -->
	
	<div class="forkme">
	<a href="https://github.com/KnivesZee" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></a>
	</div>
    <!-- github小猫 end -->
    
    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">拾碎集</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-首页">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-标签">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-归档">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-关于">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://knivezee.site/2018/07/20/2018-07-20-rubyLearnNote/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Knives">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://pj5mfieap.bkt.clouddn.com/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="拾碎集">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Ruby Learning</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-20T10:27:35+08:00">
                2018-07-20
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2018-12-03T16:04:35+08:00">
                2018-12-03
              </time>
            
          </span>

          

          
            
          

          
          
             <span id="/2018/07/20/2018-07-20-rubyLearnNote/" class="leancloud_visitors" data-flag-title="Ruby Learning">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  5,764
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  24
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>我们会出于各种目的学习自然语言。外语能带你领略一片从未见过的风景。程序语言也是如此：每学一门新的语言，思维方式就会发生改变。</p>
<p>首先选择的是一门面向对象的语言Ruby。Ruby是由松本行弘（Matz）于1993年发明，从语言角度看，它出身于脚本语言家族。它有如下特性：</p>
<ul>
<li><strong>解释型</strong>:Ruby代码由解释器而非编译器执行</li>
<li><strong>动态类型</strong>：意味着类型在运行时而非编译时绑定</li>
<li><strong>面向对象</strong>：意味着Ruby支持封装（将data和method一起打包）、继承、多态（对象可表现位多种形式）等特性</li>
</ul>
<p>从Ruby的解释型，动态型不难看出Ruby采取的策略是在灵活性和运行时间安全之间寻找安全点，事实上Ruby是一门对开发人员高效但是对运行效率不那么高效的语言。</p>
<h2 id="1-初识Ruby"><a href="#1-初识Ruby" class="headerlink" title="1. 初识Ruby"></a>1. 初识Ruby</h2><h3 id="1-1-快速起步"><a href="#1-1-快速起步" class="headerlink" title="1.1 快速起步"></a>1.1 快速起步</h3><p>Ruby有两种方式运行：</p>
<ul>
<li>irb：交互命令行执行，类似matlab</li>
<li>编写文件，使用ruby **.rb的方式运行</li>
</ul>
<h3 id="1-2-Ruby的编程模型"><a href="#1-2-Ruby的编程模型" class="headerlink" title="1.2. Ruby的编程模型"></a>1.2. Ruby的编程模型</h3><p>在接触到一门新的语言时候，首先应该考虑的是<strong>它的编程模型是什么</strong>。Ruby是一门纯面向对象语言。先来看一些基本对象：<br><img src="http://p5gvnfded.bkt.clouddn.com/irb1.png" alt="ruby的基本对象"></p>
<p>在Ruby中，一切皆为对象，连每个单独的数字也不例外。我们可以看出数字是Fixnum类型的对象，并且methods方法可以返回方法数组。</p>
<h3 id="1-3-Ruby中的判断"><a href="#1-3-Ruby中的判断" class="headerlink" title="1.3 Ruby中的判断"></a>1.3 Ruby中的判断</h3><p>与其他语言一样，Ruby有取值位true或false的表达式，并且true与false也都是first-class object。运行如下程序</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">4</span></span><br><span class="line">puts <span class="string">'1.This appears to be false.'</span> <span class="keyword">unless</span> x == <span class="number">4</span></span><br><span class="line">puts <span class="string">'2,This appears to be true'</span> <span class="keyword">if</span> x == <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> x == <span class="number">4</span></span><br><span class="line">    puts <span class="string">'3.This appears to be true'</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">unless</span> x == <span class="number">4</span></span><br><span class="line">    puts <span class="string">'4.This appears to be false'</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">puts <span class="string">'5.This appears to be true.'</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">puts <span class="string">'6.This appears to be ture'</span> <span class="keyword">if</span> !<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>运行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2,This appears to be true</span><br><span class="line">3.This appears to be true</span><br></pre></td></tr></table></figure>
<p>Ruby中使用if或者unless时，既可以选择块形式（if condition, statements, end），也可以用单行形式（statements if condition）</p>
<p>不过值得注意的是，Ruby中除了nil和false之外，其他值都代表true。即0也代表true，这点和C/C++不同。</p>
<h3 id="1-4-Duck-Typing"><a href="#1-4-Duck-Typing" class="headerlink" title="1.4 Duck Typing"></a>1.4 Duck Typing</h3><p>这里介绍一点关于Ruby类型模型的内容。首先必须知道的是当你错误的使用类型时，Ruby能给予多大程度的保护，即Type safety。强类型语言会对某些操作进行类型检查，并且在造成破坏之前加以阻止。当你把代码提交给解释器或者编译器，或者执行代码时，就会进行类型检查。</p>
<p>如你运行如下代码时：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span> + <span class="string">'four'</span></span><br></pre></td></tr></table></figure>
<p>会得到如下警告：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">TypeError:</span> String can<span class="string">'t be coerced into Fixnum</span></span><br><span class="line"><span class="string">        from (irb):1:in `+'</span></span><br><span class="line">        from (irb)<span class="symbol">:</span><span class="number">1</span></span><br><span class="line">        from <span class="symbol">:</span><span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>由此可见，Ruby是强类型语言。（但它不能完全的说是强类型语言，更加确切的说是它在大部分时间内都表现的像一门强类型语言）——这就意味着发生类型冲突时，你将得到一个错误。此外，Ruby是在运行时而非编译时进行类型检查。这点可通过在irb中定义一个函数，函数体里面放入 4 + ‘four’。然后运行该函数得以验证。</p>
<p>很容易的可以在运行时获得上个错误。所以说，知道真正尝试执行代码时，Ruby才进行类型检查。这一类型称作<strong>动态类型</strong>。</p>
<p>按照常理来说，在采用静态类型系统的情况下，编译器和工具嫩巩固捕获更多错误，因此这点是Ruby的劣势。但是动态类型也有自己的潜在优势——即多个类不必继承自相同父类，就能以相同方式使用：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line">a = [<span class="string">'100'</span>, <span class="number">100.0</span>]</span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">2</span></span><br><span class="line">        puts a[i].to_i</span><br><span class="line">        i = i + <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>输出<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">100</span><br><span class="line">100</span><br></pre></td></tr></table></figure></p>
<p>上面这个例子就是常见的鸭子类型（Duck Typing）。a数组的第一个元素是String，第二个元素是Float，而把它们转化为int的代码，却都用的是to_i。Duck Typing不在乎其类型是什么，只要它能像鸭子一样走路，像鸭子一样叫，那就可以叫它鸭子。这个例子中，to_i就相当于鸭子叫的这个动作。再举一个例子，Ruby中的数组有丰富的method，其中就包括pop，push。定义一个数组arr，由于它有pop和push方法，因此我便可以把它当作stack使用，或者可以把这个arr叫做stack。</p>
<p>对于面向对象设计的清晰性来说，Duck Typing至关重要。再面向对象设计思想中有一个重要的原则：对接口编码，不对实现编码——这是依赖反转原则（Dependency Inversion Principle）的一种实践应用。如果利用鸭子类型，实现这一原则只需极少的额外工作，就能轻松完成。如刚举过的例子，只要对象中有pop和push，它就可以当作stack来使用，反之则不可以。</p>
<h2 id="2-Ruby基础"><a href="#2-Ruby基础" class="headerlink" title="2. Ruby基础"></a>2. Ruby基础</h2><h3 id="2-1-function"><a href="#2-1-function" class="headerlink" title="2.1 function"></a>2.1 function</h3><p>与java不同，你不必为了定义函数而构建出整个类。用命令行就可以定义函数：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">this_is_function</span></span></span><br><span class="line">    <span class="literal">true</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>每个函数都会返回结果。Ruby中若你没有显式制定某个返回值，函数就将返回推出函数前最后处理的表达式的值。并且和其他事物一样，函数也是一个对象。</p>
<p>稍后将会探讨如何把函数作为参数传递给其他函数。</p>
<h3 id="2-2-Array"><a href="#2-2-Array" class="headerlink" title="2.2 Array"></a>2.2 Array</h3><p>数组是Ruby有序集合的主力军，看看如下代码：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">irb(main):001:0&gt;</span> animals = [<span class="string">'lions'</span>, <span class="string">''</span>,<span class="string">'bears'</span>]</span><br><span class="line">=&gt; [<span class="string">"lions"</span>, <span class="string">""</span>, <span class="string">"bears"</span>]</span><br><span class="line"><span class="meta">irb(main):002:0&gt;</span> puts animals</span><br><span class="line">lions</span><br><span class="line"></span><br><span class="line">bears</span><br><span class="line">=&gt; nil</span><br><span class="line"><span class="meta">irb(main):003:0&gt;</span> animals[<span class="number">0</span>]</span><br><span class="line">=&gt; <span class="string">"lions"</span></span><br><span class="line"><span class="meta">irb(main):004:0&gt;</span> animals[<span class="number">10</span>]</span><br><span class="line">=&gt; nil</span><br><span class="line"><span class="meta">irb(main):005:0&gt;</span> animals[-<span class="number">1</span>]</span><br><span class="line">=&gt; <span class="string">"bears"</span></span><br><span class="line"><span class="meta">irb(main):006:0&gt;</span> animals[<span class="number">0</span>..<span class="number">1</span>]</span><br><span class="line">=&gt; [<span class="string">"lions"</span>, <span class="string">""</span>]</span><br><span class="line"><span class="meta">irb(main):007:0&gt;</span> (<span class="number">0</span>..<span class="number">1</span>).class</span><br><span class="line">=&gt; Range</span><br></pre></td></tr></table></figure>
<p>可以看到，Ruby的集合提供了一定的灵活性，若访问任何未定义的数组元素，Ruby会返回nil。此外Ruby数组也有一些增强功能，如animail[-1]返回倒数第一个元素。这样为了便于使用而添加的特性就是<strong>语法糖</strong>。表达式animals[0..1]看似有几分像语法糖，但其实不是。0..1其实是一个Range对象，表示从0到1的所有数字。</p>
<p><strong>语法糖</strong>指的是为编程语言添加某种语法，这种语法虽对语言本身功能并无实质影响，但为程序员编程提供了便利，比如C语言用a[i]表示*( a ＋ i)、用for表示循环等语法。</p>
<p>此外数组也可以容纳其他类型的元素：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">irb(main):001:0&gt;</span> a[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line"><span class="symbol">NameError:</span> undefined local variable <span class="keyword">or</span> method <span class="string">`a' for main:Object</span></span><br><span class="line"><span class="string">        from (irb):1</span></span><br><span class="line"><span class="string">        from :0</span></span><br><span class="line"><span class="string">irb(main):002:0&gt; a =[]</span></span><br><span class="line"><span class="string">=&gt; []</span></span><br></pre></td></tr></table></figure></p>
<p>Ruby中数组也是需定义的。实际上，[]是Array类的方法：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">irb(main):001:0&gt;</span> [<span class="number">1</span>].class</span><br><span class="line">=&gt; Array</span><br><span class="line"><span class="meta">irb(main):001:0&gt;</span> [<span class="number">1</span>].methods.include?(<span class="string">'[]'</span>)</span><br><span class="line">=&gt; true</span><br></pre></td></tr></table></figure></p>
<p>这样看来，[]和[]=不过是访问数组的语法糖而已。</p>
<p>数组拥有丰富的API，可以将其用作队列、链表等等。<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">irb(main):003:0&gt;</span> [].methods</span><br><span class="line">=&gt; [<span class="string">"find"</span>, <span class="string">"[]="</span>, <span class="string">"inspect"</span>, <span class="string">"tap"</span>, <span class="string">"flatten"</span>, <span class="string">"&lt;&lt;"</span>, <span class="string">"reject!"</span>, <span class="string">"&amp;"</span>, <span class="string">"clone"</span>, <span class="string">"rindex"</span>, <span class="string">"take"</span>, <span class="string">"push"</span>, <span class="string">"object_id"</span>, <span class="string">"__send__"</span>, <span class="string">"public_methods"</span>, <span class="string">"reject"</span>, <span class="string">"transpose"</span>, <span class="string">"instance_variable_defined?"</span>, <span class="string">"minmax"</span>, <span class="string">"choice"</span>, <span class="string">"freeze"</span>, <span class="string">"equal?"</span>, <span class="string">"member?"</span>, <span class="string">"each"</span>, <span class="string">"indexes"</span>, <span class="string">"delete"</span>, <span class="string">"*"</span>, <span class="string">"sort"</span>, <span class="string">"extend"</span>, <span class="string">"partition"</span>, <span class="string">"map!"</span>, <span class="string">"uniq"</span>, <span class="string">"+"</span>, <span class="string">"each_cons"</span>, <span class="string">"send"</span>, <span class="string">"any?"</span>, <span class="string">"each_with_index"</span>, <span class="string">"to_ary"</span>, <span class="string">"methods"</span>, <span class="string">"pack"</span>, <span class="string">"values_at"</span>, <span class="string">"-"</span>, <span class="string">"detect"</span>, <span class="string">"hash"</span>, <span class="string">"dup"</span>, <span class="string">"take_while"</span>, <span class="string">"join"</span>, <span class="string">"pop"</span>, <span class="string">"replace"</span>, <span class="string">"instance_variables"</span>, <span class="string">"to_enum"</span>, <span class="string">"reverse"</span>, <span class="string">"clear"</span>, <span class="string">"collect"</span>, <span class="string">"slice!"</span>, <span class="string">"permutation"</span>, <span class="string">"min_by"</span>, <span class="string">"indices"</span>, <span class="string">"|"</span>, <span class="string">"sort_by"</span>, <span class="string">"eql?"</span>, <span class="string">"size"</span>, <span class="string">"enum_cons"</span>, <span class="string">"group_by"</span>, <span class="string">"id"</span>, <span class="string">"instance_eval"</span>, <span class="string">"flatten!"</span>, <span class="string">"one?"</span>, <span class="string">"enum_with_index"</span>, <span class="string">"at"</span>, <span class="string">"singleton_methods"</span>, <span class="string">"delete_at"</span>, <span class="string">"find_index"</span>, <span class="string">"nitems"</span>, <span class="string">"taint"</span>, <span class="string">"empty?"</span>, <span class="string">"drop"</span>, <span class="string">"shift"</span>, <span class="string">"instance_variable_get"</span>, <span class="string">"enum_for"</span>, <span class="string">"map"</span>, <span class="string">"frozen?"</span>, <span class="string">"fill"</span>, <span class="string">"display"</span>, <span class="string">"instance_of?"</span>, <span class="string">"combination"</span>, <span class="string">"max_by"</span>, <span class="string">"uniq!"</span>, <span class="string">"method"</span>, <span class="string">"grep"</span>, <span class="string">"to_a"</span>, <span class="string">"first"</span>, <span class="string">"compact"</span>, <span class="string">"instance_exec"</span>, <span class="string">"type"</span>, <span class="string">"none?"</span>, <span class="string">"reverse_each"</span>, <span class="string">"fetch"</span>, <span class="string">"protected_methods"</span>, <span class="string">"find_all"</span>, <span class="string">"&lt;=&gt;"</span>, <span class="string">"delete_if"</span>, <span class="string">"=="</span>, <span class="string">"min"</span>, <span class="string">"reverse!"</span>, <span class="string">"insert"</span>, <span class="string">"==="</span>, <span class="string">"drop_while"</span>, <span class="string">"unshift"</span>, <span class="string">"instance_variable_set"</span>, <span class="string">"concat"</span>, <span class="string">"sort!"</span>, <span class="string">"assoc"</span>, <span class="string">"each_slice"</span>, <span class="string">"inject"</span>, <span class="string">"respond_to?"</span>, <span class="string">"kind_of?"</span>, <span class="string">"minmax_by"</span>, <span class="string">"product"</span>, <span class="string">"count"</span>, <span class="string">"to_s"</span>, <span class="string">"class"</span>, <span class="string">"last"</span>, <span class="string">"shuffle!"</span>, <span class="string">"index"</span>, <span class="string">"zip"</span>, <span class="string">"private_methods"</span>, <span class="string">"=~"</span>, <span class="string">"tainted?"</span>, <span class="string">"__id__"</span>, <span class="string">"select"</span>, <span class="string">"shuffle"</span>, <span class="string">"length"</span>, <span class="string">"max"</span>, <span class="string">"untaint"</span>, <span class="string">"nil?"</span>, <span class="string">"each_index"</span>, <span class="string">"entries"</span>, <span class="string">"cycle"</span>, <span class="string">"collect!"</span>, <span class="string">"rassoc"</span>, <span class="string">"slice"</span>, <span class="string">"enum_slice"</span>, <span class="string">"reduce"</span>, <span class="string">"include?"</span>, <span class="string">"is_a?"</span>, <span class="string">"compact!"</span>, <span class="string">"[]"</span>, <span class="string">"all?"</span>]</span><br></pre></td></tr></table></figure></p>
<h3 id="2-3-Hash-table"><a href="#2-3-Hash-table" class="headerlink" title="2.3 Hash table"></a>2.3 Hash table</h3><p>散列表，中的对象为一对对key-value对。Ruby中的Hash table如下：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">numbers = &#123; <span class="number">1</span>=&gt;<span class="string">'one'</span>, <span class="number">2</span>=&gt;<span class="string">'two'</span> &#125;</span><br><span class="line">stuff = &#123;<span class="symbol">:array</span> =&gt; [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="symbol">:string</span> =&gt; <span class="string">'Hello'</span>&#125;</span><br></pre></td></tr></table></figure>
<p>可以用numbers[key]来进行访问。上述例子第二个散列表很有趣，因为再这里引入了symbol。symbol是前面带有冒号的标识符，类似于:symbol的形式，它在给事物和概念命名时特别好用。尽管两个同值字符串在内存中位置不同，但是相同的符号确实同一个物理对象。比如运行如下代码：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">irb(main):001:0&gt;</span> <span class="string">'string'</span>.object_id</span><br><span class="line">=&gt; <span class="number">70102288028240</span></span><br><span class="line"><span class="meta">irb(main):002:0&gt;</span> <span class="string">'string'</span>.object_id</span><br><span class="line">=&gt; <span class="number">70102288003160</span></span><br><span class="line"><span class="meta">irb(main):003:0&gt;</span> <span class="symbol">:string</span>.object_id</span><br><span class="line">=&gt; <span class="number">151708</span></span><br><span class="line"><span class="meta">irb(main):004:0&gt;</span> <span class="symbol">:string</span>.object_id</span><br><span class="line">=&gt; <span class="number">151708</span></span><br></pre></td></tr></table></figure></p>
<p>此外，散列表拥有一些别出心裁的应用。比如，Ruby不支持命名参数，但是可以用散列表模拟。只要加入一颗小小的语法糖，你就可以获取一些有趣的特性：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tell_the_truth</span><span class="params">(options=&#123;&#125;)</span></span></span><br><span class="line">    <span class="keyword">if</span> options[<span class="symbol">:profession</span>] == <span class="symbol">:lawyer</span></span><br><span class="line">            puts <span class="string">'it could be believed that this is almost certaionly not false.'</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">            puts <span class="string">'true'</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">tell_the_truth</span><br><span class="line">tell_the_truth <span class="symbol">:profession</span> =&gt; <span class="symbol">:lawyer</span></span><br></pre></td></tr></table></figure></p>
<p>运行结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">true</span><br><span class="line">it could be believed that this is almost certaionly not false.</span><br></pre></td></tr></table></figure></p>
<p>该方法带一个可选参数。若不传入该参数，options将设为空散列表，但如果传入:profession =&gt; :lawyer，返回结果就有所不同。他不会返回true，但因为Ruby的求值机制将字符串也当作true处理，若以这和返回true几乎毫无差别。这里的散列表可以不必用大括号括起来，因为散列表用作函数的最后一个参数时，大括号可有可无。</p>
<h3 id="2-4-Block-amp-yield"><a href="#2-4-Block-amp-yield" class="headerlink" title="2.4 Block &amp; yield"></a>2.4 Block &amp; yield</h3><p>Block是一个匿名函数，他可以作为参数传递给函数或方法，比如：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">irb(main):001:0&gt;</span> <span class="number">3</span>.times &#123;puts <span class="string">'Hello'</span>&#125;</span><br><span class="line">Hello</span><br><span class="line">Hello</span><br><span class="line">Hello</span><br></pre></td></tr></table></figure></p>
<p>大括号中间的代码就称为block。times是Fixnum类的方法，他会执行n次Block。Block有两种形式：</p>
<ul>
<li>{ / }</li>
<li>do / end</li>
</ul>
<p>Ruby的惯例是代码只占一行时用大括号，代码占用多行时用do / end。代码块可带有一个或多个参数：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">test = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">test.each &#123; <span class="params">|a|</span> puts a&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td></tr></table></figure></p>
<p>上述代码仅用少许语句就遍历并打印了每个元素。其实现可以使用下面的自定义的times方法：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fixnum</span></span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">my_times</span></span></span><br><span class="line">        i = <span class="keyword">self</span></span><br><span class="line">        <span class="keyword">while</span> i &gt; <span class="number">0</span></span><br><span class="line">            i = i-<span class="number">1</span></span><br><span class="line">            <span class="keyword">yield</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>.my_times &#123;puts <span class="string">'mangy mouse'</span>&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mangy mouse</span><br><span class="line">mangy mouse</span><br><span class="line">mangy mouse</span><br></pre></td></tr></table></figure></p>
<p>上述代码打开一个现有类，并向其中添加一个方法，它用yield调用代码块，并且循坏某个给定次数。block还可以用作一等参数（即可将block作为参数直接传递给函数），看看下面的例子：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">call_block</span><span class="params">(&amp;block)</span></span></span><br><span class="line">    block.call</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pass_block</span><span class="params">(&amp;block)</span></span></span><br><span class="line">    call_block(&amp;block)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">pass_block &#123;puts <span class="string">'Hello,block'</span>&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello,block</span><br></pre></td></tr></table></figure></p>
<p>在ruby中，参数名前面加一个‘&amp;’，表示将代码块作为闭包传递给函数。</p>
<p>这个结束能让你把可执行代码派发给其他的方法。在Ruby中，代码块不仅可用于循环，还可以用于延迟执行：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execute_at_noon &#123;puts <span class="string">'Beep beep... time to get up'</span>&#125;</span><br></pre></td></tr></table></figure></p>
<p>代码中的行为即puts，不会马上执行，而要等到调用该代码块的相关的yield时才会执行。如执行某些条件为：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">in_case_of_mergency <span class="keyword">do</span></span><br><span class="line">    use_credit_card</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">in_case_of_mergency</span></span></span><br><span class="line">    <span class="keyword">yield</span> <span class="keyword">if</span> emergency?</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<p>强制实施某种策略：<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">within_a_transaction <span class="keyword">do</span></span><br><span class="line">    thing_that</span><br><span class="line">    must_happen_together</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">within_a_transaction</span></span></span><br><span class="line">    begin_transaction</span><br><span class="line">    <span class="keyword">yield</span></span><br><span class="line">    end_transaction</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<p>以及诸多其他用途，包括处理文件的每一行，执行HTTP事物中的人物，在集合上进行各种复杂的操作等。</p>
<h3 id="2-5-定义类"><a href="#2-5-定义类" class="headerlink" title="2.5 定义类"></a>2.5 定义类</h3><p>和其他面向对象语言一样，Ruby也有类和对象。想想饼干模板和饼干，类(class)就是对象(object)的模板，即类为饼干模板，对象是饼干。与C++不同的是，Ruby中的类只能继承自一个叫做superclass的类。<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">puts <span class="number">4</span>.<span class="keyword">class</span></span><br><span class="line">puts <span class="number">4</span>.<span class="keyword">class</span>.superclass</span><br><span class="line">puts <span class="number">4</span>.<span class="keyword">class</span>.superclass.superclass</span><br><span class="line">puts <span class="number">4</span>.<span class="keyword">class</span>.superclass.superclass.superclass</span><br><span class="line">puts <span class="number">4</span>.<span class="keyword">class</span>.superclass.superclass.superclass.superclass</span><br></pre></td></tr></table></figure></p>
<p>输出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Fixnum</span><br><span class="line">Integer</span><br><span class="line">Numeric</span><br><span class="line">Object</span><br><span class="line">nil</span><br></pre></td></tr></table></figure></p>
<p>Ruby中，所有的事物都继承自Object。一个Class同时也是一个Module。Class的实例将作为对象的模板。在上述例子中，Fixnunm是Integer Class的一个实例，而4又是Fixnum的一个实例。每一个类同时也是一个对象。<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">puts <span class="number">4</span>.<span class="keyword">class</span>.<span class="class"><span class="keyword">class</span></span></span><br><span class="line">puts <span class="number">4</span>.<span class="keyword">class</span>.<span class="class"><span class="keyword">class</span>.<span class="title">superclass</span></span></span><br><span class="line">puts <span class="number">4</span>.<span class="keyword">class</span>.<span class="class"><span class="keyword">class</span>.<span class="title">superclass</span>.<span class="title">superclass</span></span></span><br></pre></td></tr></table></figure></p>
<p>输出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class</span><br><span class="line">Module</span><br><span class="line">Object</span><br></pre></td></tr></table></figure></p>
<p>如此看来Fixnum派生自Class类。</p>
<p>下面我们用类来实现一个简单的Tree：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tree</span></span></span><br><span class="line">    <span class="keyword">attr_accessor</span> <span class="symbol">:children</span>, <span class="symbol">:node_name</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(name, children=[])</span></span></span><br><span class="line">            @children = children</span><br><span class="line">            @node_name = name</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">visit</span><span class="params">(&amp;block)</span></span></span><br><span class="line">            block.call <span class="keyword">self</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">visit_all</span><span class="params">(&amp;block)</span></span></span><br><span class="line">            visit &amp;block</span><br><span class="line">            children.each&#123; <span class="params">|c|</span> c.visit_all &amp;block&#125;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">ruby_tree = Tree.new(<span class="string">"Ruby"</span>,[Tree.new(<span class="string">"Reia"</span>),Tree.new(<span class="string">"MacRuby"</span>)] )</span><br><span class="line"></span><br><span class="line">puts <span class="string">"Visting a node"</span></span><br><span class="line">ruby_tree.visit &#123;<span class="params">|node|</span> puts node.node_name&#125;</span><br><span class="line">puts <span class="string">"Visting entire tree"</span></span><br><span class="line">ruby_tree.visit_all &#123;<span class="params">|node|</span> puts node.node_name&#125;</span><br></pre></td></tr></table></figure>
<p>这个类实现了一个简单的树。它有三个方法：initiallize、visit和visit_all。还有两个实例变量：children和node_name。初始化一个新对象的时候，会调用initiallize这个方法。</p>
<p>在此说说Ruby中的<strong>命名规则</strong>：</p>
<ul>
<li>类应该以大写字母开头，采用驼峰命名法(eg：BiTree)</li>
<li>实例变量前必须加上@</li>
<li>类变量前必须加上@@</li>
<li>实例变量和方法名以小写字母开头，采用下划线命名法</li>
<li>常量采用全大写，下划线命名法</li>
<li>用于逻辑测试的函数和方法一般要加上问好(if test?)</li>
</ul>
<p>上述Tree类，利用了block和Recursion，使用户可以访问树中所有的节点，每个Tree类的实例都带有一个节点。initiallize方法设置了children和node_name的值。visit方法调用传入的代码块。visit_all方法现对当前节点调用visit方法，再对每个子节点递归调用visit_all方法。最终产生如下的输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Visting a node</span><br><span class="line">Ruby</span><br><span class="line"></span><br><span class="line">Visting entire tree</span><br><span class="line">Ruby</span><br><span class="line">Reia</span><br><span class="line">MacRuby</span><br></pre></td></tr></table></figure>
<h3 id="2-6-Mixin"><a href="#2-6-Mixin" class="headerlink" title="2.6 Mixin"></a>2.6 Mixin</h3><p>面向对象语言利用继承，将行为传播到类似的对象上。但对象若想继承并不相似的多种行为，一方面可以以多继承实现，另一方面也可以借助其他解决方案。但是多继承不仅复杂，而且问题多多。Java采用接口解决了这一问题，而Ruby采用的是模块。模块（Module）是函数和常量的集合。如果类中包含了一个模块，那么该模块的行为和常量也会成为类的一部分。</p>
<p>通过下面这个类，我们可以把to_f方法添加到任意一个类上:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">ToFile</span></span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">filename</span></span></span><br><span class="line">        <span class="string">"object_<span class="subst">#&#123;<span class="keyword">self</span>.object_id&#125;</span>.txt"</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">w_to_file</span></span></span><br><span class="line">        File.open(filename, <span class="string">'w'</span>) &#123;<span class="params">|f|</span> f.write(to_s)&#125;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line">    <span class="keyword">include</span> ToFile</span><br><span class="line">    <span class="keyword">attr_accessor</span> <span class="symbol">:name</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(name)</span></span></span><br><span class="line">        @name = name</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_s</span></span></span><br><span class="line">        name</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">Person.new(<span class="string">'matz'</span>).w_to_file</span><br></pre></td></tr></table></figure>
<p>开始是模块定义，它定义了两个方法：w_to_file把to_s方法的输出写入文件，filename方法提供了写入文件的文件名。有趣的是：<strong>to_s在模块中使用，在类中实现</strong>，但是定义模块的时候，实现它的类甚至还没有定义，这说明，模块与包含它的类之间，是以一种很隐秘的方式相互作用的。模块依赖的类方法通常不多。在Java中，这种依赖关系是隐式的，即类会实现一个约束方法名的接口；而在Ruby中，这种依赖关系是是隐式的，即通过Duck Type实现的。</p>
<p>对于Person类的细节，我们完全不感兴趣，这正是关键所在。的确，我们在Person类中包含了模块，但写入文件的能力，和这个类是不是Person没有一点关系，也可以是Animal等等。我们是通过Mixin（混入）的方式，实现了在文件中添加内容的功能。我们可以对Person类添加新的minxin，也可以派生新的子类，这些子类虽然不了解mixin的具体实现，但仍然拥有mixin的功能。这种由上至SmallTalk下至Python的众多语言采用的编程风格，称之为minxin。这些语言中，带mixin的载体虽然未必都成为Module，但基本是一致的，使用单继承结合mixin的方式，尽可能的合理的把各种行为打包在一起。</p>
<h3 id="2-7-两个重要的Mixin——enumerable-amp-comparable"><a href="#2-7-两个重要的Mixin——enumerable-amp-comparable" class="headerlink" title="2.7 两个重要的Mixin——enumerable&amp;comparable"></a>2.7 两个重要的Mixin——enumerable&amp;comparable</h3><p>若想让类可枚举，必须实现each方法；如果想让类比较，比较实现&lt;=&gt;操作符。它被成为太空船操作符，比较a、b两数，a比较大时返回1，b大返回-1，相等则返回0。为避免方法实现之苦，集合已实现了许多便于使用的可枚举和可比较的方法。</p>
<p>打开命令行输入如下代码：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">irb(main):004:0&gt;</span> <span class="string">'begin'</span> &lt;=&gt; <span class="string">'end'</span></span><br><span class="line">=&gt; -<span class="number">1</span></span><br><span class="line"><span class="meta">irb(main):006:0&gt;</span> <span class="string">'same'</span>&lt;=&gt;<span class="string">'same'</span></span><br><span class="line">=&gt; <span class="number">0</span></span><br><span class="line"><span class="meta">irb(main):001:0&gt;</span> a = [<span class="number">5</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>]</span><br><span class="line">=&gt; [<span class="number">5</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>]</span><br><span class="line"><span class="meta">irb(main):003:0&gt;</span> a.sort</span><br><span class="line">=&gt; [<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">irb(main):004:0&gt;</span> a.any? &#123;<span class="params">|i|</span> i&gt;<span class="number">7</span>&#125;</span><br><span class="line">=&gt; false</span><br><span class="line"><span class="meta">irb(main):005:0&gt;</span> a.any? &#123;<span class="params">|i|</span> i&gt;<span class="number">4</span>&#125;</span><br><span class="line">=&gt; true</span><br><span class="line"><span class="meta">irb(main):006:0&gt;</span> a.all? &#123;<span class="params">|i|</span> i&gt;<span class="number">4</span>&#125;</span><br><span class="line">=&gt; false</span><br><span class="line"><span class="meta">irb(main):007:0&gt;</span> a.all? &#123;<span class="params">|i|</span> i&gt;<span class="number">0</span>&#125;</span><br><span class="line">=&gt; true</span><br><span class="line"><span class="meta">irb(main):008:0&gt;</span> a.collect &#123;<span class="params">|i|</span> i*<span class="number">2</span>&#125;</span><br><span class="line">=&gt; [<span class="number">10</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">irb(main):011:0&gt;</span> a.select&#123;<span class="params">|i|</span> i%<span class="number">2</span> == <span class="number">0</span>&#125;</span><br><span class="line">=&gt; [<span class="number">4</span>]</span><br><span class="line"><span class="meta">irb(main):012:0&gt;</span> a.max</span><br><span class="line">=&gt; <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>只要集合中任一元素条件为真，any?就返回true；只有集合所有元素条件为真，all？才返回true。由于证书已经通过Fixnum类实现了太空船操作符，因此可以调用sort方法排序，还可以调用min和max方法计算最大值和最小值。</p>
<p>同时，也可以做一些基于set的操作。collect和map方法把函数应用到每个元素上，并返回结果数组。find方法找到一个符合条件的元素，而select和find_all方法均返回所有符合条件的元素。并且还可以用inject方法计算列表的和与积：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">irb(main):019:0&gt;</span> a</span><br><span class="line">=&gt; [<span class="number">5</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>]</span><br><span class="line"><span class="meta">irb(main):022:0&gt;</span> a.inject(<span class="number">0</span>) &#123;<span class="params">|sum,i|</span> sum+i&#125;</span><br><span class="line">=&gt; <span class="number">13</span></span><br><span class="line"><span class="meta">irb(main):023:0&gt;</span> a.inject &#123;<span class="params">|sum,i|</span> sum+i&#125;</span><br><span class="line">=&gt; <span class="number">13</span></span><br><span class="line"><span class="meta">irb(main):026:0&gt;</span> a.inject&#123;<span class="params">|product,i|</span> product*i&#125;</span><br><span class="line">=&gt; <span class="number">60</span></span><br><span class="line"></span><br><span class="line"><span class="meta">irb(main):027:0&gt;</span> a.inject(<span class="number">0</span>) do <span class="params">|sum,i|</span></span><br><span class="line">irb(main)<span class="symbol">:</span><span class="number">02</span>8<span class="symbol">:</span><span class="number">1</span>*     puts <span class="string">"sum: <span class="subst">#&#123;sum&#125;</span> i:<span class="subst">#&#123;i&#125;</span> sum+i:<span class="subst">#&#123;sum+i&#125;</span>"</span></span><br><span class="line"><span class="meta">irb(main):029:1&gt;</span>     sum+i</span><br><span class="line"><span class="meta">irb(main):030:1&gt;</span> end</span><br><span class="line"><span class="symbol">sum:</span> <span class="number">0</span> <span class="symbol">i:</span><span class="number">5</span> sum+<span class="symbol">i:</span><span class="number">5</span></span><br><span class="line"><span class="symbol">sum:</span> <span class="number">5</span> <span class="symbol">i:</span><span class="number">3</span> sum+<span class="symbol">i:</span><span class="number">8</span></span><br><span class="line"><span class="symbol">sum:</span> <span class="number">8</span> <span class="symbol">i:</span><span class="number">4</span> sum+<span class="symbol">i:</span><span class="number">12</span></span><br><span class="line"><span class="symbol">sum:</span> <span class="number">12</span> <span class="symbol">i:</span><span class="number">1</span> sum+<span class="symbol">i:</span><span class="number">13</span></span><br><span class="line">=&gt; <span class="number">13</span></span><br></pre></td></tr></table></figure>
<p>inject方法后面跟一个block，里面由两个参数和一个表达式。inject会通过第二个参数，把每个列表元素传入代码块，这样代码块就能在每个列表项上执行操作。第一个参数是代码块上一次执行的结果。由于代码块第一次执行时，还没有上一次执行的结果，因此可以把初始值作为inject方法的参数传入。如果不设初始值，inject会使用集合中的第一个值。</p>
<h2 id="3-几种元编程当中的技术"><a href="#3-几种元编程当中的技术" class="headerlink" title="3. 几种元编程当中的技术"></a>3. 几种元编程当中的技术</h2><h3 id="3-1-开放类"><a href="#3-1-开放类" class="headerlink" title="3.1 开放类"></a>3.1 开放类</h3><p>它可以随时改变任何类的定义，常用于给类添加行为。这里看看如下代码：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NilClass</span></span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">blank?</span></span></span><br><span class="line">        <span class="literal">true</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">String</span></span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">blank?</span></span></span><br><span class="line">        <span class="keyword">self</span>.size == <span class="number">0</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">[<span class="string">""</span>,<span class="string">"Person"</span>,<span class="literal">nil</span>].each <span class="keyword">do</span> <span class="params">|element|</span></span><br><span class="line">    puts element <span class="keyword">unless</span> element.blank?</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>输出结果为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person</span><br></pre></td></tr></table></figure></p>
<p>Ruby中，在某个类名上首次调用class关键字会调用一个类，若该类已经定义过，再调用class会修改之前的类定义。以上代码对现有的类NilClass和String添加了一个blank？方法。添加这个方法的原因是，判断一个字符串是否为空或者为nil。有了这个小巧的方法，仅需要一次方法调用，就能快速检查出后两种空状态，因为blank?都会返回true。不管字符串用的哪个类，只要提供blank？方法，这么检查就没问题。只要走起来像鸭子，它就是只鸭子。</p>
<h3 id="3-2-使用method-missing"><a href="#3-2-使用method-missing" class="headerlink" title="3.2 使用method_missing"></a>3.2 使用method_missing</h3><p>Ruby找不到某个方法时，会调用一个特殊的调试方法显示诊断信息。</p>
<p>只要我们覆盖method_missing方法，就可以实现一些有趣的行为。如下面代码所示：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Roman</span></span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">method_missing</span> <span class="title">name</span>, *<span class="title">args</span></span></span><br><span class="line">        roman = name.to_s</span><br><span class="line">        roman.gsub!(<span class="string">"IV"</span>,<span class="string">"IIII"</span>)</span><br><span class="line">        roman.gsub!(<span class="string">"IX"</span>,<span class="string">"VIIII"</span>)</span><br><span class="line">        roman.gsub!(<span class="string">"XL"</span>,<span class="string">"XXXX"</span>)</span><br><span class="line">        roman.gsub!(<span class="string">"XC"</span>,<span class="string">"LXXXX"</span>)</span><br><span class="line"></span><br><span class="line">        (roman.count(<span class="string">"I"</span>)+</span><br><span class="line">         roman.count(<span class="string">"V"</span>)* <span class="number">5</span> +</span><br><span class="line">         roman.count(<span class="string">"X"</span>)* <span class="number">10</span> +</span><br><span class="line">         roman.count(<span class="string">"L"</span>)* <span class="number">50</span> +</span><br><span class="line">         roman.count(<span class="string">"C"</span>)* <span class="number">100</span>)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">puts Roman.X</span><br><span class="line">puts Roman.XC</span><br><span class="line">puts Roman.XII</span><br><span class="line">puts Roman.X</span><br></pre></td></tr></table></figure>
<p>输出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">10</span><br><span class="line">90</span><br><span class="line">12</span><br><span class="line">10</span><br></pre></td></tr></table></figure></p>
<p>这段代码将method_missing方法用于实践的极佳示例。这样对比Roman.i和Roman.number_for “i”就可以看出来。</p>
<p>然而，这样做的话，我们写的类调试起来会比过去困难得多，因为Ruby再也不会告诉你找不到某个方法。</p>
<h3 id="3-3-Module"><a href="#3-3-Module" class="headerlink" title="3.3 Module"></a>3.3 Module</h3><p>Ruby最流行的元编程方式，非模块莫属。仅在模块中写上几行代码，就可以实现def或attr_accessor关键字的功能。甚至设计自己的领域特定语言（DSL），再用DSL定义自己的类。</p>
<h3 id="4-总结"><a href="#4-总结" class="headerlink" title="4. 总结"></a>4. 总结</h3><p>Ruby的纯面向对象可以然你用一致的方式来处理对象。Duck Typing根据对象可提供的方法，而不是对象的继承层次，实现了更切合实际的多态设计。Ruby的Module和开放类，使我们能把行为密切结合到语法上，这大大超越了类中定义的传统方法和实例变量。</p>
<p>Ruby作为脚本语言或带有合理扩展需求的Web开发语言而言，可以说是相当理想的，它的生产力很强。</p>
<p>再好的语言也有其局限性，Ruby最大的弱点就是性能。Matz也十分清楚，他写Ruby是为了改善开发人员的体验而非优化语言的性能。</p>
<p>此外，作为面向对象的语言，拥有者面向对象编程的重大弱点：该编程模型成立的一切前提条件，都建立在围绕状态包装一些列的行为的基础之上，但通常，状态是会发生改变的。于是，当程序中出现并发时，这种策略就会引发严重的问题。</p>
<p>最后，由于Duck Typing的策略下，它使用便利是有代价的。静态类型可以提供一整套工具，可以更轻松地构造语法树，因此也能实现各种IDE。因此Ruby没有一个IDE形式的调试器。</p>
<p>综上所述，Ruby核心优势是它的语法和灵活性，不足之处大概就是性能及IDE了。总之，在面向对象开发中，Ruby是一门优秀的语言。</p>

      
    </div>
    
    
    

    <div>
  		
    		<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">本文结束------<i class="fa fa-pagelines"></i>------感谢阅读</div>
    
</div>

  		
	</div>

    

    

    
      <div>
        <div class="post-copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

  <!-- JS库 sweetalert 可修改路径 -->
  <script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <p><span>本文标题:</span><a href="/2018/07/20/2018-07-20-rubyLearnNote/">Ruby Learning</a></p>
  <p><span>文章作者:</span><a href="/" title="访问 Knives 的个人博客">Knives</a></p>
  <p><span>发布时间:</span>2018年07月20日 - 10:07</p>
  <p><span>原始链接:</span><a href="/2018/07/20/2018-07-20-rubyLearnNote/" title="Ruby Learning">http://knivezee.site/2018/07/20/2018-07-20-rubyLearnNote/</a>
    <span class="copy-path" title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="http://knivezee.site/2018/07/20/2018-07-20-rubyLearnNote/" aria-label="复制成功！"></i></span>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>  
</div>
<script> 
    var clipboard = new Clipboard('.fa-clipboard');
      $(".fa-clipboard").click(function(){
      clipboard.on('success', function(){
        swal({   
          title: "",   
          text: '复制成功',
          icon: "success", 
          showConfirmButton: true
          });
        });
    });  
</script>
      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/language/" <i="" class="fa fa-tag"> language</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/05/15/2018-05-15-alogthrin-analise/" rel="next" title="算法分析基础">
                <i class="fa fa-chevron-left"></i> 算法分析基础
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/07/25/2018-07-25-IoLearn/" rel="prev" title="Io Learning">
                Io Learning <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="http://pj5mfieap.bkt.clouddn.com/avatar.jpg" alt="Knives">
            
              <p class="site-author-name" itemprop="name">Knives</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

			<!--my custom code begin-->
			<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.5.0/velocity.min.js"></script>
			<script type="text/javascript">
			  $("#sidebar").hover(function(){
				$("#mydivshow").velocity('stop').velocity({opacity: 1});
			  },function(){
				$("#mydivshow").velocity('stop').velocity({opacity: 0});
			  });
			</script>
			<div id="mydivshow" class="mydivshow">
			<!--my custom code end-->
			
          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/kniveszee" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:kniveszee@gmail.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://weibo.com/kniveszee" target="_blank" title="微博">
                    
                      <i class="fa fa-fw fa-weibo"></i>微博</a>
                </span>
              
            
          </div>

          
          

          
          

          <div id="player1" class="aplayer"></div>
<script src="/js/src/APlayer.min.js"></script>
<script type="text/javascript">
var ap = new APlayer({
    element: document.getElementById('player1'),                       // Optional, player element
    narrow: false,                                                     // Optional, narrow style
    autoplay: false,                                                    // Optional, autoplay song(s), not supported by mobile browsers
    showlrc: 0,                                                        // Optional, show lrc, can be 0, 1, 2, see: ###With lrc
    mutex: true,                                                       // Optional, pause other players when this player playing
    theme: '#e6d0b2',                                                  // Optional, theme color, default: #b7daff
    mode: 'random',                                                    // Optional, play mode, can be `random` `single` `circulation`(loop) `order`(no loop), default: `circulation`
    preload: 'metadata',                                               // Optional, the way to load music, can be 'none' 'metadata' 'auto', default: 'auto'
    listmaxheight: '513px',                                             // Optional, max height of play list
    music: {                                                           // Required, music info, see: ###With playlist
        title: '奇迹の山',                                          // Required, music title
        author: '岸部眞明',                          // Required, music author
        url: 'http://p8ciruasa.bkt.clouddn.com/%E5%B2%B8%E9%83%A8%E7%9C%9E%E6%98%8E%20-%20%E5%A5%87%E8%BF%B9%E3%81%AE%E5%B1%B1.mp3',  // Required, music url
        pic: 'http://p8ciruasa.bkt.clouddn.com/fc1f4134970a304ef38c4ac0d0c8a786c9175c5a.jpg',  // Optional, music picture
    }
});
</script>
        </div>
		<!--my custom code begin-->
		</div>
		<!--my custom code end-->
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-初识Ruby"><span class="nav-number">1.</span> <span class="nav-text">1. 初识Ruby</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-快速起步"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 快速起步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-Ruby的编程模型"><span class="nav-number">1.2.</span> <span class="nav-text">1.2. Ruby的编程模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-Ruby中的判断"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 Ruby中的判断</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-Duck-Typing"><span class="nav-number">1.4.</span> <span class="nav-text">1.4 Duck Typing</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Ruby基础"><span class="nav-number">2.</span> <span class="nav-text">2. Ruby基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-function"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Array"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 Array</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-Hash-table"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 Hash table</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-Block-amp-yield"><span class="nav-number">2.4.</span> <span class="nav-text">2.4 Block &amp; yield</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-定义类"><span class="nav-number">2.5.</span> <span class="nav-text">2.5 定义类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-Mixin"><span class="nav-number">2.6.</span> <span class="nav-text">2.6 Mixin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-两个重要的Mixin——enumerable-amp-comparable"><span class="nav-number">2.7.</span> <span class="nav-text">2.7 两个重要的Mixin——enumerable&amp;comparable</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-几种元编程当中的技术"><span class="nav-number">3.</span> <span class="nav-text">3. 几种元编程当中的技术</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-开放类"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 开放类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-使用method-missing"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 使用method_missing</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-Module"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 Module</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-总结"><span class="nav-number">3.4.</span> <span class="nav-text">4. 总结</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-star"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Knives</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">28.8k</span>
  
</div>






<!--
  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a></div>
-->



        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  







  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>




  


  




	





  





  












  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("", "");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  

  
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.3"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.3"></script>


  
  <script type="text/javascript" src="/js/src/exturl.js?v=5.1.3"></script>


  <script src="/js/src/Aplayer-Controler.js"></script>
<div id="AP-controler"></div>
<script type="text/javascript">
var myapc=new APlayer_Controler({
		APC_dom:$('#AP-controler'),
		aplayer:ap, //此为绑定的aplayer对象
		attach_right:false,
		position:{top:'300px',bottom:''},
		fixed:true,
		btn_width:100,
		btn_height:120,
		img_src:['http://oty1v077k.bkt.clouddn.com/bukagirl.jpg',
				'http://oty1v077k.bkt.clouddn.com/pentigirl.jpg'],
		img_style:{repeat:'no-repeat',position:'center',size:'contain'},
		ctrls_color:'rgba(173,255,47,0.8)',
		ctrls_hover_color:'rgba(255,140,0,0.7)',
		tips_on:true,
		tips_width:140,
		tips_height:25,
		tips_color:'rgba(255,255,255,0.6)',
		tips_content:{},
		timeout:30
	});
</script>
  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

<!-- 页面点击小红心 -->

<script type="text/javascript" src="/js/src/love.js"></script>





  <scripttype="text javascript"color="255,0,0" opacity="0.5" count="10" src="/lib/canvas-nest/canvas-nest.min.js">


</scripttype="text></body>
</html>
